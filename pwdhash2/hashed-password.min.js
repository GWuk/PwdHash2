function SPH_HashedPassword(a,b,c,d){var e=this._getHashedPassword(a,b,c,d);this.toString=function(){return e}}SPH_HashedPassword.prototype={_getHashedPassword:function(a,b,c,d){var e=a.length+SPH_kPasswordPrefix.length;var f=forge.util.encode64(forge.pkcs5.pbkdf2(a+c,b,d,(2*e/3)+16,forge.sha256.create()));var g=a.match(/\W/)!=null;var h=this._applyConstraints(f,e,g);return h},_applyConstraints:function(d,e,f){var g=e-4;var h=d.substring(0,g);var i=d.substring(g).split('');function nextExtra(){return i.length?i.shift().charCodeAt(0):0}function nextExtraChar(){return String.fromCharCode(nextExtra())}function rotate(a,b){while(b--)a.push(a.shift())}function between(a,b,c){return a+c%b}function nextBetween(a,b){return String.fromCharCode(between(a.charCodeAt(0),b,nextExtra()))}function contains(a){return h.match(a)}h+=(contains(/[A-Z]/)?nextExtraChar():nextBetween('A',26));h+=(contains(/[a-z]/)?nextExtraChar():nextBetween('a',26));h+=(contains(/[0-9]/)?nextExtraChar():nextBetween('0',10));h+=(contains(/\W/)&&f?nextExtraChar():'+');while(contains(/\W/)&&!f){h=h.replace(/\W/,nextBetween('A',26))}h=h.split('');rotate(h,nextExtra());return h.join('')}}function SPH_HashedPassword_MD5(a,b){var c=this._getHashedPassword(a,b);this.toString=function(){return c}}SPH_HashedPassword_MD5.prototype={_getHashedPassword:function(a,b){var c=b64_hmac_md5(a,b);var d=a.length+SPH_kPasswordPrefix.length;var e=a.match(/\W/)!=null;var f=this._applyConstraints(c,d,e);return f},_applyConstraints:function(d,e,f){var g=e-4;var h=d.substring(0,g);var i=d.substring(g).split('');function nextExtra(){return i.length?i.shift().charCodeAt(0):0}function nextExtraChar(){return String.fromCharCode(nextExtra())}function rotate(a,b){while(b--)a.push(a.shift())}function between(a,b,c){return a+c%b}function nextBetween(a,b){return String.fromCharCode(between(a.charCodeAt(0),b,nextExtra()))}function contains(a){return h.match(a)}h+=(contains(/[A-Z]/)?nextExtraChar():nextBetween('A',26));h+=(contains(/[a-z]/)?nextExtraChar():nextBetween('a',26));h+=(contains(/[0-9]/)?nextExtraChar():nextBetween('0',10));h+=(contains(/\W/)&&f?nextExtraChar():'+');while(contains(/\W/)&&!f){h=h.replace(/\W/,nextBetween('A',26))}h=h.split('');rotate(h,nextExtra());return h.join('')}}